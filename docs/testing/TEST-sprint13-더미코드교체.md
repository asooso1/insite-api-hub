# Sprint 13 테스트 체크리스트: 더미 코드 교체 및 정리

**작성일**: 2026-01-27
**Sprint**: 13 (Phase 4A - 프로덕션 안정화)
**테스트 환경**: http://localhost:3000

---

## 사전 준비

1. Docker 컨테이너 실행: `docker-compose up -d`
2. 의존성 설치: `npm install`
3. 개발 서버 시작: `npm run dev`
4. `.env` 파일에 `APP_BASE_URL=http://localhost:3000` 확인

---

## DUMMY-01: 하드코딩 URL 수정

### TC-01-1: APP_BASE_URL 환경변수 적용 확인

**대상 파일**: `src/app/actions/webhook.ts`, `import-repo.ts`, `scenario.ts`, `batch-test.ts`

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | `.env` 파일에서 `APP_BASE_URL=http://localhost:3000` 확인 | 환경변수가 존재함 | [ ] |
| 2 | `grep -r "localhost:3000" src/app/actions/` 실행 | 결과 없음 (하드코딩 제거됨) | [ ] |
| 3 | `grep -r "APP_BASE_URL" src/app/actions/` 실행 | 5곳에서 환경변수 참조 확인 | [ ] |
| 4 | Webhook 알림 전송 트리거 → Dooray 메시지 확인 | 링크가 APP_BASE_URL 값으로 생성됨 | [ ] |

### TC-01-2: example.com 플레이스홀더 제거 확인

**대상 파일**: `init.sql`, `src/lib/migration.ts`, `scripts/migrate.js`

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | `grep "example.com" init.sql` 실행 | 결과 없음 | [ ] |
| 2 | `grep "example.com" src/lib/migration.ts` 실행 | 결과 없음 | [ ] |
| 3 | `grep "example.com" scripts/migrate.js` 실행 | 결과 없음 | [ ] |
| 4 | DB에서 `SELECT * FROM environments;` 실행 | STG/PRD의 base_url이 빈 문자열 | [ ] |

### TC-01-3: payload-generator faker.js 연동 확인

**대상 파일**: `src/lib/payload-generator.ts`
**확인 경로**: 테스트 탭 → 임의 엔드포인트 → 테스트 실행

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | 엔드포인트 상세 → 테스트 탭 → 자동 생성된 payload 확인 | `user@example.com` 같은 고정값이 아닌 랜덤 데이터 | [ ] |
| 2 | 동일 엔드포인트에서 테스트를 2번 실행 | 매번 다른 payload가 생성됨 | [ ] |
| 3 | 이름 필드가 있는 DTO의 경우 | 한국어 이름이 생성됨 (faker 한국어 로케일) | [ ] |
| 4 | email 필드가 있는 경우 | `xxx@xxx.xxx` 형식의 실제 이메일 | [ ] |
| 5 | URL 필드가 있는 경우 | `https://xxx.xxx` 형식의 실제 URL | [ ] |

---

## DUMMY-02: 미구현 기능 완성

### TC-02-1: Webhook 로그 DB 저장

**확인 경로**: 설정 → Webhook → GitHub webhook 전송 후 DB 확인

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | GitHub에서 test webhook 전송 (또는 curl로 직접 호출) | 200 OK 응답 | [ ] |
| 2 | DB에서 `SELECT * FROM webhook_logs ORDER BY created_at DESC LIMIT 5;` | 방금 전송한 webhook 로그가 저장됨 | [ ] |
| 3 | 로그에 `event_type`, `verified`, `processed` 필드 확인 | 올바른 값으로 저장됨 | [ ] |

### TC-02-2: V2Sidebar 사용자 정보 세션 연동

**확인 경로**: 사이드바 하단 사용자 영역

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | 로그인 후 사이드바 확장 (호버) | "User Name" 대신 실제 로그인 사용자 이름 표시 | [ ] |
| 2 | 이메일 표시 확인 | "user@example.com" 대신 실제 이메일 표시 | [ ] |
| 3 | 아바타 이미지 확인 | 사용자 이름 기반 고유 아바타 생성 (dicebear seed) | [ ] |
| 4 | 다른 계정으로 로그인 | 해당 계정의 이름/이메일/아바타로 변경 | [ ] |

### TC-02-3: RepoImporter 단계별 진행률

**확인 경로**: 대시보드 → 저장소 가져오기

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | 유효한 Git URL 입력 후 가져오기 실행 | 진행 메시지가 단계별로 변경됨 | [ ] |
| 2 | 진행 중 메시지 관찰 | "저장소 연결 확인 중" → "저장소 클론 중" → "Spring Controller 스캔 중" → "DTO 구조 분석 중" → "API 엔드포인트 매핑 중" → "완료!" | [ ] |
| 3 | 프로그레스 바가 10% → 20% → 40% → 60% → 75% → 100% 순서로 증가 | 순차적으로 증가 (이전처럼 랜덤이 아님) | [ ] |

### TC-02-4: DashboardOverview 실제 DB 통계

**확인 경로**: 대시보드 메인 페이지

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | 대시보드 메인 → 상단 통계 카드 확인 | 하드코딩 "+12%", "+8%" 대신 실제 데이터 수량 표시 | [ ] |
| 2 | 전체 엔드포인트 카드 | 실제 엔드포인트 개수 표시 (예: "42개") | [ ] |
| 3 | 데이터 모델 카드 | 실제 모델 개수 표시 | [ ] |
| 4 | 테스트 성공률 카드 | 테스트 데이터 없으면 0% (94% 하드코딩 아님) | [ ] |
| 5 | 최근 활동 섹션 | 하드코딩 데이터가 아닌 실제 DB 활동 로그 | [ ] |
| 6 | 활동 데이터가 없을 때 | "아직 활동이 없습니다" 빈 상태 메시지 | [ ] |

### TC-02-5: Admin 온라인 상태 세션 연동

**확인 경로**: /admin 페이지 → 사용자 목록

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | Admin 페이지 접속 → 사용자 목록 확인 | 모든 사용자가 "온라인"이 아닌 실제 상태 표시 | [ ] |
| 2 | 현재 로그인 중인 사용자 | 녹색 점 + "온라인 (Active)" | [ ] |
| 3 | 비활성 세션의 사용자 | 회색 점 + "오프라인" | [ ] |

### TC-02-6: Admin MoreVertical 드롭다운 메뉴

**확인 경로**: /admin 페이지 → 사용자 행 → ⋮ 버튼

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | ⋮ (MoreVertical) 버튼 클릭 | 드롭다운 메뉴 표시 (프로필 보기, 역할 변경, 비활성화) | [ ] |
| 2 | 메뉴 외부 클릭 | 메뉴 자동 닫힘 | [ ] |
| 3 | "프로필 보기" 클릭 | toast 알림 표시 ("기능은 준비 중입니다.") | [ ] |
| 4 | "역할 변경" 클릭 | toast 알림 표시 | [ ] |
| 5 | "비활성화" 클릭 | toast 알림 표시 (빨간색 텍스트) | [ ] |
| 6 | 다른 사용자의 ⋮ 클릭 | 이전 메뉴 닫히고 새 메뉴 열림 | [ ] |

---

## CLEANUP-01: 코드 정리

### TC-CL-1: 미사용 의존성 제거

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | `grep "supabase" package.json` 실행 | 결과 없음 | [ ] |
| 2 | `grep "next-auth" package.json` 실행 | 결과 없음 | [ ] |
| 3 | `npm ls @supabase/supabase-js 2>&1` 실행 | "not found" 또는 에러 | [ ] |
| 4 | `npm run dev` 정상 실행 | 에러 없이 개발 서버 시작 | [ ] |
| 5 | `npx tsc --noEmit 2>&1 | grep -v __tests__` | 에러 없음 | [ ] |

### TC-CL-2: 환경설정 정리

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | `.env` 파일에서 Supabase 참조 확인 | 관련 라인 없음 | [ ] |
| 2 | `docker-compose.yml` 첫 줄 확인 | `version:` 필드 없음 (`services:` 로 시작) | [ ] |
| 3 | `docker-compose up -d` 실행 | 경고 없이 정상 실행 | [ ] |

### TC-CL-3: init.sql 기본 프로젝트

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | `init.sql`에서 "Default Project" 검색 | 주석 처리되어 있음 | [ ] |
| 2 | 새 DB로 init.sql 실행 시 | 기본 프로젝트가 자동 생성되지 않음 | [ ] |

---

## 빌드 검증

| # | 테스트 절차 | 예상 결과 | 통과 |
|---|-----------|----------|------|
| 1 | `npm run dev` 실행 | 에러 없이 시작 | [ ] |
| 2 | `npx tsc --noEmit` 실행 (테스트 파일 제외) | 타입 에러 없음 | [ ] |
| 3 | http://localhost:3000 접속 | 대시보드 정상 표시 | [ ] |
| 4 | 사이드바 모든 탭 클릭 | 페이지 전환 정상 | [ ] |

---

## 테스트 결과 요약

| 카테고리 | 전체 | 통과 | 실패 | 미테스트 |
|---------|------|------|------|---------|
| DUMMY-01 (URL) | 14 | | | |
| DUMMY-02 (기능) | 22 | | | |
| CLEANUP-01 (정리) | 10 | | | |
| 빌드 검증 | 4 | | | |
| **합계** | **50** | | | |

---

**테스트 완료일**: ____년 __월 __일
**테스터**: ________________
**비고**:
